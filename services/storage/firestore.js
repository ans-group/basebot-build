'use strict';Object.defineProperty(exports, "__esModule", { value: true });var _firebase = require('./firebase');

const teamsRef = _firebase.db.collection('teams');
const usersRef = _firebase.db.collection('users');
const channelsRef = _firebase.db.collection('channels');

const driver = {
  teams: {
    get: get(teamsRef),
    save: save(teamsRef),
    all: all(teamsRef) },

  channels: {
    get: get(channelsRef),
    save: save(channelsRef),
    all: all(channelsRef) },

  users: {
    get: get(usersRef),
    save: save(usersRef),
    all: all(usersRef) } };exports.default =


driver;

function get(firebaseRef) {
  return id => new Promise((resolve, reject) => firebaseRef.doc(id).get().then(doc => {
    if (!doc.exists) {
      reject(Error('Document not found'));
    } else {
      resolve(doc.data());
    }
  }).catch(reject));
}

function save(firebaseRef) {
  return data => firebaseRef.doc(data.id).set(data, { merge: true });
}

function all(firebaseRef) {
  return () => new Promise((resolve, reject) => firebaseRef.get().then(snapshot => {
    resolve(snapshot.toArray().map(doc => doc.data()));
  }).catch(reject));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NlcnZpY2VzL3N0b3JhZ2UvZmlyZXN0b3JlLmpzIl0sIm5hbWVzIjpbInRlYW1zUmVmIiwiZGIiLCJjb2xsZWN0aW9uIiwidXNlcnNSZWYiLCJjaGFubmVsc1JlZiIsImRyaXZlciIsInRlYW1zIiwiZ2V0Iiwic2F2ZSIsImFsbCIsImNoYW5uZWxzIiwidXNlcnMiLCJmaXJlYmFzZVJlZiIsImlkIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJkb2MiLCJ0aGVuIiwiZXhpc3RzIiwiRXJyb3IiLCJkYXRhIiwiY2F0Y2giLCJzZXQiLCJtZXJnZSIsInNuYXBzaG90IiwidG9BcnJheSIsIm1hcCJdLCJtYXBwaW5ncyI6IjJFQUFBOztBQUVBLE1BQU1BLFdBQVdDLGFBQUdDLFVBQUgsQ0FBYyxPQUFkLENBQWpCO0FBQ0EsTUFBTUMsV0FBV0YsYUFBR0MsVUFBSCxDQUFjLE9BQWQsQ0FBakI7QUFDQSxNQUFNRSxjQUFjSCxhQUFHQyxVQUFILENBQWMsVUFBZCxDQUFwQjs7QUFFQSxNQUFNRyxTQUFTO0FBQ2JDLFNBQU87QUFDTEMsU0FBS0EsSUFBSVAsUUFBSixDQURBO0FBRUxRLFVBQU1BLEtBQUtSLFFBQUwsQ0FGRDtBQUdMUyxTQUFLQSxJQUFJVCxRQUFKLENBSEEsRUFETTs7QUFNYlUsWUFBVTtBQUNSSCxTQUFLQSxJQUFJSCxXQUFKLENBREc7QUFFUkksVUFBTUEsS0FBS0osV0FBTCxDQUZFO0FBR1JLLFNBQUtBLElBQUlMLFdBQUosQ0FIRyxFQU5HOztBQVdiTyxTQUFPO0FBQ0xKLFNBQUtBLElBQUlKLFFBQUosQ0FEQTtBQUVMSyxVQUFNQSxLQUFLTCxRQUFMLENBRkQ7QUFHTE0sU0FBS0EsSUFBSU4sUUFBSixDQUhBLEVBWE0sRUFBZixDOzs7QUFpQmVFLE07O0FBRWYsU0FBU0UsR0FBVCxDQUFjSyxXQUFkLEVBQTJCO0FBQ3pCLFNBQU9DLE1BQU0sSUFBSUMsT0FBSixDQUFZLENBQUNDLE9BQUQsRUFBVUMsTUFBVixLQUFxQkosWUFBWUssR0FBWixDQUFnQkosRUFBaEIsRUFBb0JOLEdBQXBCLEdBQTBCVyxJQUExQixDQUErQkQsT0FBTztBQUNsRixRQUFJLENBQUNBLElBQUlFLE1BQVQsRUFBaUI7QUFDZkgsYUFBT0ksTUFBTSxvQkFBTixDQUFQO0FBQ0QsS0FGRCxNQUVPO0FBQ0xMLGNBQVFFLElBQUlJLElBQUosRUFBUjtBQUNEO0FBQ0YsR0FONkMsRUFNM0NDLEtBTjJDLENBTXJDTixNQU5xQyxDQUFqQyxDQUFiO0FBT0Q7O0FBRUQsU0FBU1IsSUFBVCxDQUFlSSxXQUFmLEVBQTRCO0FBQzFCLFNBQU9TLFFBQVFULFlBQVlLLEdBQVosQ0FBZ0JJLEtBQUtSLEVBQXJCLEVBQXlCVSxHQUF6QixDQUE2QkYsSUFBN0IsRUFBbUMsRUFBRUcsT0FBTyxJQUFULEVBQW5DLENBQWY7QUFDRDs7QUFFRCxTQUFTZixHQUFULENBQWNHLFdBQWQsRUFBMkI7QUFDekIsU0FBTyxNQUFNLElBQUlFLE9BQUosQ0FBWSxDQUFDQyxPQUFELEVBQVVDLE1BQVYsS0FBcUJKLFlBQVlMLEdBQVosR0FBa0JXLElBQWxCLENBQXVCTyxZQUFZO0FBQy9FVixZQUFRVSxTQUFTQyxPQUFULEdBQW1CQyxHQUFuQixDQUF1QlYsT0FBT0EsSUFBSUksSUFBSixFQUE5QixDQUFSO0FBQ0QsR0FGNkMsRUFFM0NDLEtBRjJDLENBRXJDTixNQUZxQyxDQUFqQyxDQUFiO0FBR0QiLCJmaWxlIjoiZmlyZXN0b3JlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGIgfSBmcm9tICcuL2ZpcmViYXNlJ1xuXG5jb25zdCB0ZWFtc1JlZiA9IGRiLmNvbGxlY3Rpb24oJ3RlYW1zJylcbmNvbnN0IHVzZXJzUmVmID0gZGIuY29sbGVjdGlvbigndXNlcnMnKVxuY29uc3QgY2hhbm5lbHNSZWYgPSBkYi5jb2xsZWN0aW9uKCdjaGFubmVscycpXG5cbmNvbnN0IGRyaXZlciA9IHtcbiAgdGVhbXM6IHtcbiAgICBnZXQ6IGdldCh0ZWFtc1JlZiksXG4gICAgc2F2ZTogc2F2ZSh0ZWFtc1JlZiksXG4gICAgYWxsOiBhbGwodGVhbXNSZWYpXG4gIH0sXG4gIGNoYW5uZWxzOiB7XG4gICAgZ2V0OiBnZXQoY2hhbm5lbHNSZWYpLFxuICAgIHNhdmU6IHNhdmUoY2hhbm5lbHNSZWYpLFxuICAgIGFsbDogYWxsKGNoYW5uZWxzUmVmKVxuICB9LFxuICB1c2Vyczoge1xuICAgIGdldDogZ2V0KHVzZXJzUmVmKSxcbiAgICBzYXZlOiBzYXZlKHVzZXJzUmVmKSxcbiAgICBhbGw6IGFsbCh1c2Vyc1JlZilcbiAgfVxufVxuZXhwb3J0IGRlZmF1bHQgZHJpdmVyXG5cbmZ1bmN0aW9uIGdldCAoZmlyZWJhc2VSZWYpIHtcbiAgcmV0dXJuIGlkID0+IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IGZpcmViYXNlUmVmLmRvYyhpZCkuZ2V0KCkudGhlbihkb2MgPT4ge1xuICAgIGlmICghZG9jLmV4aXN0cykge1xuICAgICAgcmVqZWN0KEVycm9yKCdEb2N1bWVudCBub3QgZm91bmQnKSlcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzb2x2ZShkb2MuZGF0YSgpKVxuICAgIH1cbiAgfSkuY2F0Y2gocmVqZWN0KSlcbn1cblxuZnVuY3Rpb24gc2F2ZSAoZmlyZWJhc2VSZWYpIHtcbiAgcmV0dXJuIGRhdGEgPT4gZmlyZWJhc2VSZWYuZG9jKGRhdGEuaWQpLnNldChkYXRhLCB7IG1lcmdlOiB0cnVlIH0pXG59XG5cbmZ1bmN0aW9uIGFsbCAoZmlyZWJhc2VSZWYpIHtcbiAgcmV0dXJuICgpID0+IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IGZpcmViYXNlUmVmLmdldCgpLnRoZW4oc25hcHNob3QgPT4ge1xuICAgIHJlc29sdmUoc25hcHNob3QudG9BcnJheSgpLm1hcChkb2MgPT4gZG9jLmRhdGEoKSkpXG4gIH0pLmNhdGNoKHJlamVjdCkpXG59XG4iXX0=